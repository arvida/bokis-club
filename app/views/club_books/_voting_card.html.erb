<% is_voted = local_assigns[:user_vote] && user_vote&.club_book_id == club_book.id %>
<div class="flex gap-4 p-4 rounded-lg <%= is_voted ? 'bg-sage/10 border border-sage/30' : 'bg-cream/30' %>">
  <div class="flex-shrink-0 w-16">
    <%= render "shared/book_cover", book: club_book.book, class: "w-full shadow rounded" %>
  </div>

  <div class="flex-1 min-w-0">
    <h3 class="font-display text-lg font-light mb-1 truncate"><%= club_book.book.title %></h3>
    <% if club_book.book.authors.present? %>
      <p class="text-ink-muted text-sm mb-2 truncate"><%= club_book.book.author_names %></p>
    <% end %>

    <div class="flex items-center gap-2 text-ink-subtle text-xs">
      <span><%= t("club_books.vote.votes", count: club_book.vote_count) %></span>
    </div>
  </div>

  <div class="flex-shrink-0 flex items-center">
    <% if is_voted %>
      <span class="px-4 py-2 text-sage text-sm font-medium flex items-center gap-1">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
        </svg>
        <%= t("club_books.vote.voted") %>
      </span>
    <% elsif !has_voted %>
      <%= button_to t("club_books.vote.vote"),
          vote_club_club_books_path(@club, club_book_id: club_book.id),
          method: :post,
          class: "px-4 py-2.5 bg-vermillion text-white text-sm font-medium rounded-lg hover:bg-vermillion-dark transition-colors" %>
    <% end %>
  </div>
</div>
