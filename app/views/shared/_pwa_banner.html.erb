<%# Show banner on mobile when in browser (not standalone PWA) suggesting to open the app %>
<div id="pwa-open-banner" class="hidden bg-sage text-white px-4 py-3 rounded-lg mb-6">
  <div class="flex items-center justify-between gap-4">
    <div class="flex items-center gap-3">
      <span class="text-lg">ðŸ“±</span>
      <span class="text-sm font-medium"><%= t("pwa.open_in_app") %></span>
    </div>
    <button type="button" onclick="dismissPwaBanner()" class="text-white/70 hover:text-white p-3 -mr-3" aria-label="<%= t("pwa.dismiss") %>">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </div>
</div>

<script>
  (function() {
    const isStandalone = window.matchMedia('(display-mode: standalone)').matches ||
                         window.navigator.standalone === true;
    const isMobile = window.matchMedia('(max-width: 640px)').matches;
    const hasLoginCookie = document.cookie.includes('show_pwa_banner=1');

    if (isMobile && !isStandalone && hasLoginCookie) {
      document.getElementById('pwa-open-banner').classList.remove('hidden');
      document.cookie = 'show_pwa_banner=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
    }
  })();

  function dismissPwaBanner() {
    document.getElementById('pwa-open-banner').classList.add('hidden');
  }
</script>
