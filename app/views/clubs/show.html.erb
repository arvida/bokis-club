<div>
  <%# Hero image - visual moment, no text overlay %>
  <div class="h-32 sm:h-40 md:h-56 overflow-hidden">
    <%= image_tag @club.cover_url, alt: @club.name, class: "w-full h-full object-cover" %>
  </div>

  <div class="max-w-2xl mx-auto px-2 sm:px-6 pt-4">
    <%= render "shared/back_link", path: dashboard_path %>
  </div>

  <%# Live meeting banner %>
  <% if @live_meeting && @is_member %>
    <%= link_to club_meeting_path(@club, @live_meeting),
        class: "block bg-sage text-white px-4 py-3 active:bg-sage-dark transition-colors" do %>
      <div class="max-w-2xl mx-auto flex items-center justify-between gap-4">
        <div class="flex items-center gap-3">
          <span class="relative flex h-2.5 w-2.5">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-white"></span>
          </span>
          <span class="font-medium text-sm"><%= t("clubs.live_meeting.banner_title") %></span>
        </div>
        <div class="flex items-center gap-2 text-sm">
          <span><%= @live_meeting.title.truncate(30) %></span>
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
          </svg>
        </div>
      </div>
    <% end %>
  <% end %>

  <%# Content on clean paper %>
  <div class="px-2 sm:px-6 pt-6 pb-8 max-w-2xl mx-auto">
    <span class="inline-block text-xs font-medium tracking-widest text-vermillion mb-2">
      <%= t("clubs.show.department") %>
    </span>

    <h1 class="font-display text-3xl md:text-4xl font-light mb-4">
      <%= @club.name %>
    </h1>

    <% if @club.description.present? %>
      <p class="text-ink-light leading-relaxed mb-6 sm:mb-8">
        <%= @club.description %>
      </p>
    <% else %>
      <div class="mb-4 sm:mb-6"></div>
    <% end %>

    <%= render "club_books/now_reading", club: @club, is_admin: @is_admin %>

    <% if @is_admin %>
      <%= render "clubs/getting_started", club: @club %>
    <% end %>

    <% if @next_club_book %>
      <%= render "clubs/next_book_section",
          club: @club,
          next_club_book: @next_club_book,
          is_admin: @is_admin %>
    <% end %>

    <% if @is_member && @voting_active %>
      <%= render "clubs/voting_section",
          club: @club,
          voting_books: @voting_books,
          user_vote: @user_vote,
          is_admin: @is_admin %>
    <% elsif @is_member && !@next_club_book %>
      <%= render "clubs/book_actions",
          club: @club,
          suggestions_count: @suggestions_count,
          voting_active: @voting_active,
          is_admin: @is_admin,
          upcoming_meetings_count: @upcoming_meetings_count,
          meeting_soon: @meeting_soon %>
    <% end %>

    <% if @is_member %>
      <%= render "clubs/next_meeting", club: @club, is_admin: @is_admin %>
    <% end %>

    <% if @is_member %>
      <%= render "clubs/recent_messages", club: @club, messages: @recent_messages %>
    <% end %>

    <div class="flex items-center justify-between mb-6 sm:mb-8">
      <%= link_to club_members_path(@club), class: "group flex items-center gap-3 min-h-[44px] py-2" do %>
        <div class="flex -space-x-2">
          <% @club.members.limit(4).each do |member| %>
            <%= render "shared/avatar", user: member, size: :sm, border: true %>
          <% end %>
          <% if @club.members.count > 4 %>
            <div class="w-8 h-8 rounded-full bg-ink/5 border-2 border-paper flex items-center justify-center">
              <span class="text-xs text-ink-muted">+<%= @club.members.count - 4 %></span>
            </div>
          <% end %>
        </div>
        <span class="text-sm text-ink-muted group-hover:text-ink transition-colors">
          <%= t("clubs.show.members", count: @club.members.count) %> â†’
        </span>
      <% end %>

      <% if @is_admin %>
        <%= link_to t("clubs.show.settings"), edit_club_path(@club), class: "min-h-[44px] flex items-center px-3 text-sm text-ink-muted hover:text-ink transition-colors" %>
      <% end %>
    </div>

    <% if @is_member %>
      <div class="pt-8 border-t border-cream">
        <%= button_to t("clubs.show.leave"),
            leave_club_path(@club),
            method: :delete,
            form: { data: { turbo_confirm: t("clubs.show.leave_confirm") } },
            class: "px-4 py-2 border border-ink-muted text-ink-muted text-sm font-medium rounded-lg hover:border-vermillion hover:text-vermillion transition-colors" %>
      </div>
    <% elsif @club.privacy == "open" %>
      <div class="pt-8 border-t border-cream">
        <%= button_to t("clubs.show.join"),
            join_club_path(@club),
            method: :post,
            class: "px-6 py-3 bg-vermillion text-white font-medium rounded-lg hover:bg-vermillion-dark transition-colors" %>
      </div>
    <% else %>
      <div class="pt-8 border-t border-cream text-center">
        <p class="text-ink-muted text-sm"><%= t("clubs.show.closed") %></p>
        <p class="text-ink-subtle text-xs mt-1"><%= t("clubs.show.closed_hint") %></p>
      </div>
    <% end %>
  </div>
</div>
